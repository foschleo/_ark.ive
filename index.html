
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>_ark.ive | Dynamic Collection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;700&family=Lekton:wght@400;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Inter', sans-serif;
        background-color: #FDFBF7; /* Off-White */
        margin: 0; /* Ensures true centering */
      }
      .font-lekton {
        font-family: 'Lekton', monospace;
      }
      .whitespace-pre-wrap {
        white-space: pre-wrap;
      }
      .blink {
        animation: blink-animation 1s steps(2, start) infinite;
      }
      @keyframes blink-animation {
        to {
          visibility: hidden;
        }
      }
      @keyframes fade-in {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fade-in {
        animation: fade-in 0.5s ease-out forwards;
      }
    </style>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      // --- UI Components ---
      const ProjectTextSection = ({title, content, sub = false}) => (
        <div className="mb-8">
            {sub ? 
                <h4 className="font-medium mb-2 text-gray-800">{title}</h4> :
                <h3 className="font-medium text-lg mb-4">{title}</h3> 
            }
            <p className="text-sm font-light leading-relaxed text-gray-600 whitespace-pre-wrap">{content}</p>
        </div>
       );

       const ProjectShowcase = ({ projectsData }) => {
        const [currentProjectIndex, setCurrentProjectIndex] = useState(0);
        const [currentImageIndex, setCurrentImageIndex] = useState(1);
        const [transitionEnabled, setTransitionEnabled] = useState(true);
        const isClickLocked = useRef(false);
        const transitionDuration = 700;
        
        const activeProject = projectsData[currentProjectIndex];
        if (!activeProject) return null;

        const hasImages = activeProject && activeProject.images && activeProject.images.length > 0;
        const slides = hasImages ? [activeProject.images[activeProject.images.length - 1], ...activeProject.images, activeProject.images[0]] : [];
        
        const handleNextImage = () => {
          if (isClickLocked.current || !hasImages || activeProject.images.length <= 1) return;
          isClickLocked.current = true;
          setTransitionEnabled(true);
          setCurrentImageIndex((prev) => prev + 1);
        };
        
        const handleProjectChange = (index) => {
            if (index === currentProjectIndex || isClickLocked.current) return;
            isClickLocked.current = true;
            setCurrentProjectIndex(index);
            setCurrentImageIndex(1);
            setTransitionEnabled(false);
            setTimeout(() => { isClickLocked.current = false; }, 300);
        }

        useEffect(() => {
          if (!slides || slides.length <= 1) { isClickLocked.current = false; return; };
          if (currentImageIndex === slides.length - 1 || currentImageIndex === 0) {
            const timer = setTimeout(() => {
              setTransitionEnabled(false);
              setCurrentImageIndex(currentImageIndex === 0 ? slides.length - 2 : 1);
            }, transitionDuration);
            return () => clearTimeout(timer);
          }
          const unlockTimer = setTimeout(() => { isClickLocked.current = false; }, transitionDuration);
          return () => clearTimeout(unlockTimer);
        }, [currentImageIndex, slides, transitionDuration]);
        
        useEffect(() => {
          if (!transitionEnabled) {
            const timer = setTimeout(() => setTransitionEnabled(true), 50);
            return () => clearTimeout(timer);
          }
        }, [transitionEnabled]);

        let displayIndex = currentImageIndex - 1;
        if (displayIndex < 0) displayIndex = activeProject.images.length - 1;
        else if (displayIndex >= activeProject.images.length) displayIndex = 0;

        const AttributeRow = ({ label, value }) => (
            <div className="flex justify-between py-2 border-b border-gray-200">
                <dt className="text-sm font-medium text-gray-500">{label}</dt>
                <dd className="text-sm text-gray-900 text-right">{value}</dd>
            </div>
        );

        return (
            <div className="mt-12 md:mt-20">
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8 md:gap-12">
                    <div className="md:col-span-2">
                        <div className="relative aspect-[4/3] bg-gray-100 overflow-hidden cursor-pointer" onClick={handleNextImage}>
                            <div className="absolute top-0 left-0 w-full h-full flex" 
                                style={{ 
                                    transform: `translateX(-${currentImageIndex * 100}%)`,
                                    transition: transitionEnabled ? `transform ${transitionDuration}ms ease-in-out` : 'none'
                                }}>
                                {slides.map((img, index) => (
                                    <img key={index} src={img} alt={`${activeProject.projectName} image ${index}`} className="w-full h-full object-cover flex-shrink-0"/>
                                ))}
                            </div>
                            {hasImages && activeProject.images.length > 1 && (
                                <div className="absolute bottom-4 right-4 text-xs font-mono bg-black bg-opacity-50 text-white px-2 py-1 rounded">
                                    {`${displayIndex + 1} / ${activeProject.images.length}`}
                                </div>
                            )}
                        </div>
                    </div>
                    <div>
                        <h2 className="text-2xl font-medium mb-4">{activeProject.projectName}</h2>
                        <dl>
                            <AttributeRow label="Architect" value={activeProject.architect} />
                            <AttributeRow label="Location" value={activeProject.location} />
                            <AttributeRow label="Completed" value={activeProject.yearCompleted} />
                            <AttributeRow label="Type" value={activeProject.buildingType} />
                            <AttributeRow label="Materials" value={activeProject.primaryMaterials.join(', ')} />
                        </dl>
                        <div className="mt-6 text-sm">
                            <p className="font-light leading-relaxed text-gray-600">{activeProject.introductionAndContext}</p>
                        </div>
                    </div>
                </div>

                <div className="mt-8 md:mt-12 grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12">
                    <div>
                        <ProjectTextSection title="Conceptual Framework" content={activeProject.conceptualFramework} />
                        <ProjectTextSection title="Significance & Impact" content={activeProject.significanceAndImpact} />
                    </div>
                    <div>
                        <ProjectTextSection title="Architectural Analysis" content={null}>
                            <ProjectTextSection title="Form & Structure" content={activeProject.architecturalAnalysis.formAndStructure} sub={true} />
                            <ProjectTextSection title="Materiality & Tectonics" content={activeProject.architecturalAnalysis.materialityAndTectonics} sub={true} />
                            <ProjectTextSection title="Light & Space" content={activeProject.architecturalAnalysis.lightAndSpace} sub={true} />
                        </ProjectTextSection>
                    </div>
                </div>

                {projectsData.length > 1 && (
                    <div className="mt-8 border-t border-gray-200 pt-4">
                        <h4 className="text-sm font-medium text-gray-500 mb-3">Other Projects</h4>
                        <div className="flex flex-wrap gap-x-6 gap-y-2">
                            {projectsData.map((project, index) => (
                                <button
                                    key={project.id}
                                    onClick={() => handleProjectChange(index)}
                                    className={`text-sm transition-colors ${currentProjectIndex === index ? 'font-medium text-gray-900' : 'font-light text-gray-500 hover:text-gray-800'}`}
                                >
                                    {project.projectName}
                                </button>
                            ))}
                        </div>
                    </div>
                )}
            </div>
        )
    };

      const ArchitectPage = ({ architect, onBack }) => (
        <div className="max-w-5xl mx-auto px-4 py-8 md:py-12 animate-fade-in">
          <header className="grid grid-cols-1 md:grid-cols-3 gap-8 md:gap-12">
            <div className="w-full aspect-[4/5] bg-gray-100">
                <img src={architect.image} alt={`Portrait of ${architect.fullName}`} className="w-full h-full object-cover" />
            </div>
            <div className="md:col-span-2">
                <h1 className="text-4xl md:text-5xl font-bold mb-4">{architect.fullName}</h1>
                <p className="text-base font-light leading-relaxed text-gray-600">{architect.synopsis}</p>
            </div>
          </header>
          
          <main className="mt-12 md:mt-20">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12">
                <div>
                    <ProjectTextSection title="Early Life & Education" content={architect.earlyLifeAndEducation} />
                    <ProjectTextSection title="Key Materials & Tectonic Expression" content={architect.keyMaterialsAndTectonicExpression} />
                </div>
                <div>
                    <ProjectTextSection title="Philosophical Approach" content={architect.philosophicalApproachAndDesignPrinciples.summary} />
                    {architect.philosophicalApproachAndDesignPrinciples.principles.map(p => (
                        <ProjectTextSection key={p.name} title={p.name} content={p.description} sub={true} />
                    ))}
                </div>
            </div>
            <div className="mt-8 md:mt-12">
                 <ProjectTextSection title="Influence & Legacy" content={architect.influenceAndLegacy} />
            </div>

            <ProjectShowcase projectsData={architect.notableProjects} />
          </main>

          <footer className="w-full mt-16 py-4">
              <div className="max-w-5xl mx-auto flex justify-between items-center">
                   <button onClick={onBack} className="text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors">
                      Back to Collection
                  </button>
                  <h2 className="font-lekton text-xl text-gray-800">
                      <span className="blink">_</span>ark.ive
                  </h2>
              </div>
          </footer>
        </div>
      );

      const SearchInput = ({ value, onChange, onExit }) => {
        const inputRef = useRef(null);

        useEffect(() => {
          inputRef.current?.focus();
          
          const handleKeyDown = (event) => {
            if (event.key === 'Escape') {
              onExit();
            }
          };

          window.addEventListener('keydown', handleKeyDown);
          return () => {
            window.removeEventListener('keydown', handleKeyDown);
          };
        }, [onExit]);
        
        return (
          <div className="font-lekton text-2xl md:text-3xl text-gray-500 flex items-center border-b border-gray-400 pb-2">
            <span className="text-gray-800 mr-2"><span className="blink">_</span></span>
            <span className="text-gray-400 mr-4 select-none">Search</span>
            <span className="h-6 w-px bg-gray-400 mr-4"></span>
            <input
              ref={inputRef}
              type="text"
              value={value}
              onChange={onChange}
              className="bg-transparent w-full outline-none text-gray-800 placeholder-gray-400 font-lekton"
              placeholder="architect"
            />
          </div>
        );
      };

      const CollectionContainer = ({ onSelectArchitect, architects }) => {
        const [isSearching, setIsSearching] = useState(false);
        const [query, setQuery] = useState('');

        const handleSearchChange = (e) => {
          setQuery(e.target.value);
        };

        const filteredArchitects = architects.filter(arch => 
          arch.fullName.toLowerCase().includes(query.toLowerCase())
        );

        return (
          <div className="relative min-h-screen">
            <div id="collection-container" className={`min-h-screen flex flex-col p-4 transition-all duration-500 ease-in-out ${isSearching ? 'justify-start md:justify-center' : 'justify-center'}`}>
                <div id="search-wrapper" className={`w-full max-w-lg mx-auto transition-all duration-500 ease-in-out ${isSearching ? 'mt-0 mb-8 md:mt-0 md:mb-12' : 'my-4'}`}>
                {isSearching ? (
                    <SearchInput value={query} onChange={handleSearchChange} onExit={() => setIsSearching(false)} />
                ) : (
                    <h1 onClick={() => setIsSearching(true)} className="font-lekton text-5xl md:text-6xl text-gray-800 cursor-pointer text-center">
                        <span className="blink">_</span>ark.ive
                    </h1>
                )}
                </div>

                {isSearching && (
                  <div id="architects-grid" className="w-full max-w-4xl mx-auto animate-fade-in">
                      <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
                          {(query ? filteredArchitects : architects).map(arch => (
                              <div key={arch.id} onClick={() => onSelectArchitect(arch)} className="cursor-pointer group">
                                  <div className="aspect-[4/5] bg-gray-200 overflow-hidden">
                                      <img src={arch.image} alt={arch.fullName} className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300" />
                                  </div>
                                  <h3 className="mt-2 text-sm md:text-base font-medium text-gray-800">{arch.fullName}</h3>
                              </div>
                          ))}
                      </div>
                  </div>
                )}
            </div>
            <div className="absolute bottom-4 right-4 font-lekton text-xl text-gray-800">
                <span className="blink">_</span>ark.ive
            </div>
          </div>
        );
      };


      const App = () => {
        const [architects, setArchitects] = useState([]);
        const [selectedArchitect, setSelectedArchitect] = useState(null);

        useEffect(() => {
          fetch('./data.json')
            .then(response => response.json())
            .then(data => {
              setArchitects(data);
            })
            .catch(error => console.error('Error loading architect data:', error));
        }, []);

        if (selectedArchitect) {
          return <ArchitectPage architect={selectedArchitect} onBack={() => setSelectedArchitect(null)} />;
        }

        return <CollectionContainer onSelectArchitect={setSelectedArchitect} architects={architects} />;
      };

      const container = document.getElementById('root');
      const root = ReactDOM.createRoot(container);
      root.render(<App />);
    </script>
  </body>
</html>
